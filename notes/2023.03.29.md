# 实验记录2023.3.29

## 测试新交易和新账户占比

```sh
(arrl) qucheng@gpu01-inspur:~/ARRL$ python test_stack.py --window=30 --step_size=200000 --start_time="2021-07-31 00:00:00"
Real data:
Database Version: 5.7.34-0ubuntu0.18.04.1
select * from block where timestamp>=1627660800
37220
select * from tx where block_number>=12927924
7162018
dropped 6996 contract creation tx, remaining: 7155022
Step: 0
Block number: 12927924 12959094 31170
Blocks: 0 ~ 29  Size: 30
Vertex from: 1484910 Vertex to: 1111717
Vertex: 1898174
Layer: 30it [00:44,  1.49s/it]
Weight: 30it [03:49,  7.66s/it]
Vertex: 1898174 , new vertexes: [101702, 82724, 86274, 88216, 89411, 74871, 68373, 62094, 62705, 70771, 73948, 63824, 56879, 55582, 59283, 71059, 67201, 65795, 53304, 50323, 50443, 49882, 59285, 50808, 46498, 46224, 44776, 46878, 51240, 47801]
Edge: 3259111 , layer edges: [138438, 136970, 143841, 146679, 147769, 143079, 141924, 138027, 140878, 142454, 147344, 139839, 137510, 136923, 142270, 144646, 146873, 141541, 135025, 132141, 137321, 140996, 148438, 136351, 138386, 137589, 139920, 140575, 146605, 135688] , new edges: [138438, 126719, 130847, 132181, 131782, 122782, 119659, 111144, 110056, 112302, 118173, 110325, 105524, 102850, 102652, 110795, 110197, 108786, 99928, 97116, 97161, 96708, 101774, 97218, 98486, 95387, 91547, 93681, 92653, 92240] sum 3259111
vweights sum: [[400000 400000 400000 400000 400000 400000 400000 400000 400000 400000
  400000 400000 400000 400000 400000 400000 400000 400000 400000 400000
  400000 400000 400000 400000 400000 400000 400000 400000 400000 400000]] new vweights sum: [[400000 148757 147688 150553 145856 126910 118215 107185 101103 108830
  115420 104502  95481  93062  92483 101611 104737  98757  88814  85792
   84451  81967  88919  83610  83662  78422  73753  76210  79327  77813]] prop: [[1.        0.3718925 0.36922   0.3763825 0.36464   0.317275  0.2955375
  0.2679625 0.2527575 0.272075  0.28855   0.261255  0.2387025 0.232655
  0.2312075 0.2540275 0.2618425 0.2468925 0.222035  0.21448   0.2111275
  0.2049175 0.2222975 0.209025  0.209155  0.196055  0.1843825 0.190525
  0.1983175 0.1945325]]
vweights mean: [[3.93305933 3.97630124 3.70507595 3.55031687 3.43955836 3.68918607
  3.89135341 4.00052007 3.78025384 3.57458825 3.42427641 3.7200651
  3.93789933 3.96628656 3.65050103 3.41737221 3.43321117 3.57487577
  3.97903051 4.15385893 3.97069626 3.77390533 3.38569881 3.83564271
  3.90304828 3.99892029 3.83832956 3.80202838 3.50305642 3.90281979]] new vweights mean: [[3.93305933 1.79823268 1.7118483  1.70664052 1.63129816 1.69504882
  1.72897196 1.72617322 1.61235946 1.53777677 1.56082653 1.63734645
  1.67866875 1.67431902 1.56002564 1.42995257 1.55856312 1.50098032
  1.6661789  1.70482682 1.67418671 1.64321799 1.49985662 1.64560699
  1.79926018 1.69656456 1.64715473 1.62570929 1.54814598 1.62785297]]
weights sum: [[200000 200000 200000 200000 200000 200000 200000 200000 200000 200000
  200000 200000 200000 200000 200000 200000 200000 200000 200000 200000
  200000 200000 200000 200000 200000 200000 200000 200000 200000 200000]] new weights sum: [[200000 149681 151907 152518 148791 140279 139824 129269 124795 126637
  132809 127304 120891 117865 115998 123094 122448 119520 113470 111353
  110661 108727 111856 109159 110844 107664 104103 106270 102014 102561]] prop: [[1.       0.748405 0.759535 0.76259  0.743955 0.701395 0.69912  0.646345
  0.623975 0.633185 0.664045 0.63652  0.604455 0.589325 0.57999  0.61547
  0.61224  0.5976   0.56735  0.556765 0.553305 0.543635 0.55928  0.545795
  0.55422  0.53832  0.520515 0.53135  0.51007  0.512805]]
weights mean: [[1.44469004 1.46017376 1.39042415 1.3635217  1.35346385 1.39782917
  1.40920493 1.44899186 1.41966808 1.40396198 1.35736779 1.43021618
  1.45443968 1.46067498 1.40577775 1.38268601 1.36172067 1.41301814
  1.48120718 1.51353478 1.45644148 1.41847996 1.34736388 1.46680259
  1.4452329  1.45360458 1.42938822 1.42272808 1.36420995 1.4739697 ]] new weights mean: [[1.44469004 1.18120408 1.16095134 1.15385721 1.12906922 1.1425046
  1.16852055 1.16307673 1.13392273 1.12764688 1.12385232 1.15389984
  1.14562564 1.1459893  1.13001208 1.11100681 1.11117363 1.09867078
  1.13551757 1.14659788 1.13894464 1.12428134 1.09906263 1.12282705
  1.12547976 1.12870727 1.13715359 1.13438157 1.10103289 1.11189289]]
weights max: [1108.  641.  541. 1247.  937. 1115. 1427.  459. 1561. 3073.  898.  748.
  539.  471. 1560. 1764. 1424. 3562. 2187. 4263. 2053. 3189. 1890. 1607.
  898. 2322.  530. 1382.  792.  879.] new weights max: [1108.  143.   83. 1247.  287.  233.   87.  321.   60.  178.  278.  242.
   90.  307.  198.  256.  120.   46.  101.  104.  135.   92.   72.   75.
  122.   69.   62.  100.  131.  136.]
weights min: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1.] new weights min: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1.]
                                 OLS Regression Results                                
=======================================================================================
Dep. Variable:                      y   R-squared (uncentered):                   0.844
Model:                            OLS   Adj. R-squared (uncentered):              0.844
Method:                 Least Squares   F-statistic:                          6.293e+05
Date:                Wed, 29 Mar 2023   Prob (F-statistic):                        0.00
Time:                        10:07:47   Log-Likelihood:                     -2.0380e+06
No. Observations:             3259111   AIC:                                  4.076e+06
Df Residuals:                 3259083   BIC:                                  4.076e+06
Df Model:                          28                                                  
Covariance Type:            nonrobust                                                  
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
0             -0.0365      0.000    -90.918      0.000      -0.037      -0.036
1              0.0179      0.001     35.498      0.000       0.017       0.019
2              0.0132      0.001     22.887      0.000       0.012       0.014
3              0.1175      0.001    223.831      0.000       0.116       0.118
4              0.0548      0.001    105.643      0.000       0.054       0.056
5             -0.0213      0.001    -39.800      0.000      -0.022      -0.020
6             -0.0814      0.001   -162.058      0.000      -0.082      -0.080
7              0.0137      0.000     27.933      0.000       0.013       0.015
8             -0.0277      0.000    -63.156      0.000      -0.029      -0.027
9             -0.0017      0.000    -11.617      0.000      -0.002      -0.001
10             0.0495      0.000    122.188      0.000       0.049       0.050
11             0.0447      0.000     95.015      0.000       0.044       0.046
12            -0.0018      0.001     -3.318      0.001      -0.003      -0.001
13            -0.0059      0.001    -11.381      0.000      -0.007      -0.005
14            -0.0851      0.000   -207.510      0.000      -0.086      -0.084
15             0.1138      0.000    310.379      0.000       0.113       0.115
16             0.1416      0.001    267.030      0.000       0.141       0.143
17            -0.0380      0.000   -110.036      0.000      -0.039      -0.037
18            -0.0089      0.000    -22.238      0.000      -0.010      -0.008
19            -0.0648      0.000   -188.788      0.000      -0.066      -0.064
20            -0.0328      0.000    -71.209      0.000      -0.034      -0.032
21             0.0159      0.000     34.388      0.000       0.015       0.017
22             0.2420      0.001    482.557      0.000       0.241       0.243
23             0.0397      0.000     94.340      0.000       0.039       0.041
24             0.0640      0.001    126.220      0.000       0.063       0.065
25             0.1025      0.000    223.085      0.000       0.102       0.103
26             0.0742      0.001    137.351      0.000       0.073       0.075
27             0.2304      0.000    475.437      0.000       0.229       0.231
==============================================================================
Omnibus:                 11226008.667   Durbin-Watson:                   1.588
Prob(Omnibus):                  0.000   Jarque-Bera (JB):   36474906446786.359
Skew:                          63.733   Prob(JB):                         0.00
Kurtosis:                   16391.530   Cond. No.                         17.4
==============================================================================

Notes:
[1] R² is computed without centering (uncentered) since the model does not contain a constant.
[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.
MSE: 0.5414534131271391
```

可以看到，在一周的数据中，新交易占比约为50%，而新账户的交易占比约为20%。
